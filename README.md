# 字体管理器

一个简洁、现代化的Windows字体管理工具，采用扁平化UI设计，支持字体的安装、卸载、预览和搜索功能。

## ✨ 功能特性

### 🎨 现代化界面设计
- **品牌LOGO** - 精美的字体LOGO图标，专业视觉形象
- **Arco Design风格** - Tab采用下划线指示器，简洁优雅
- **DeepSeek Chat表格** - 参考DeepSeek Chat的简洁表格设计
- **线性图标** - 使用简洁的线性符号（⌕ 搜索、+ 安装、− 卸载、↻ 刷新）
- **智能按钮** - 系统字体Tab时卸载按钮自动禁用（灰色）
- **扁平化UI** - 简洁美观的现代化设计风格
- **优雅配色** - 精心设计的配色方案，视觉舒适
- **左右分栏** - 清晰的布局，左侧列表右侧预览
- **窗口图标** - 应用自定义LOGO图标，专业品质
- **交互动效** - 鼠标悬停效果，提升用户体验

### 📋 字体管理
- **Tab智能分类** - 快速切换查看"用户字体"和"系统字体"
- **简洁表格** - 无背景色干扰，纯净的列表视图
- **文件验证** - 自动过滤已删除的无效字体条目
- **保护机制** - 系统字体Tab下自动禁用卸载功能

### 📥 字体安装
- 支持批量安装 .ttf、.otf、.ttc 格式的字体文件
- **用户字体**：安装到当前用户，无需管理员权限（推荐）
- **系统字体**：安装到系统，需要管理员权限

### 🗑 字体卸载
- **用户字体**：可自由卸载，无需管理员权限
- **系统字体**：受保护，不可通过本工具卸载（符合Windows规范）

### 👁 实时预览
- 点击字体立即在右侧面板预览
- 支持多种字号显示（10pt - 24pt）
- 中英文混合预览效果

### 🔍 快速搜索
- 实时搜索过滤字体列表
- 支持字体名称、文件名搜索

## 系统要求

- Windows 7 及以上版本
- Python 3.7+ (仅开发/打包时需要)
- 管理员权限（安装/卸载字体时需要）

## 快速开始

### 方式一：直接运行 exe（推荐）

1. 下载或生成 `字体管理工具.exe`
2. **右键点击程序** → 选择 **"以管理员身份运行"**
3. 即可开始使用

### 方式二：从源码运行

1. 安装Python 3.7+

2. 安装依赖（可选，tkinter是Python内置的）：
```bash
pip install -r requirements.txt
```

3. 以管理员身份运行：
```bash
python font_manager.py
```

## 打包为 EXE

提供了两种打包脚本：

### 使用批处理脚本（推荐）
```bash
build.bat
```

### 使用PowerShell脚本
```bash
powershell -ExecutionPolicy Bypass -File build.ps1
```

打包完成后，可执行文件位于 `dist\字体管理工具.exe`

## 使用说明

### 1. 安装字体

1. 点击 **"安装字体"** 按钮
2. 选择安装类型：
   - **用户字体**（推荐）：安装到当前用户目录，无需管理员权限
   - **系统字体**：安装到系统目录，需要管理员权限
3. 选择一个或多个字体文件（支持 .ttf、.otf、.ttc）
4. 等待安装完成
5. 系统会自动刷新字体列表

💡 **提示**：推荐选择"用户字体"，这样安装更快捷，且无需管理员权限

### 2. 卸载字体

1. 在字体列表中选择要卸载的字体
2. 点击 **"卸载字体"** 按钮
3. 确认操作
4. 等待卸载完成

### 3. 预览字体

- 在左侧字体列表中点击任意字体
- 右侧面板会自动显示字体预览
- 预览内容包括：
  - 字体的基本信息
  - 大小写字母、数字
  - 中英文示例文本
  - 多种字号的显示效果（10pt~36pt）

### 4. 搜索字体

在顶部搜索框中输入关键词，列表会实时过滤显示匹配的字体。

### 5. 界面说明

**左右分栏布局**：
- **左侧** - 字体列表，显示所有已安装字体
  - 🔴 浅红色背景 = 系统字体（受保护，不可卸载）
  - 🔵 浅蓝色背景 = 用户字体（可自由管理）
- **右侧** - 预览面板，点击字体即时显示预览

**状态栏**：
- 显示字体总数
- 系统字体和用户字体的分别统计

**提示栏**：
- 顶部会提示"系统字体不可卸载"，避免误操作

## 注意事项

⚠️ **重要提示**

1. **字体类型选择** 
   - 推荐安装为"用户字体"，无需管理员权限，仅当前用户可用
   - 安装为"系统字体"需要管理员权限，所有用户可用
2. **系统字体保护** 
   - 系统字体（浅红色）不可通过本工具卸载
   - 这是为了保护系统稳定性，符合Windows字体管理规范
   - 如需卸载系统字体，请使用Windows系统设置
3. **管理员权限** 
   - 安装/卸载用户字体：无需管理员权限
   - 安装系统字体：需要管理员权限
4. **字体文件** - 确保字体文件格式正确且未损坏
5. **备份** - 卸载重要字体前建议先备份字体文件
6. **用户字体目录** - 用户字体安装在 `%LOCALAPPDATA%\Microsoft\Windows\Fonts`

## 技术架构

- **GUI框架**: Tkinter（Python内置，无需额外安装）
- **系统交互**: winreg（Windows注册表操作）
- **打包工具**: PyInstaller
- **字体支持格式**: .ttf (TrueType)、.otf (OpenType)、.ttc (TrueType Collection)

## 项目结构

```
Windows-Font/
│
├── font_manager.py      # 主程序文件
├── requirements.txt     # Python依赖列表
├── build.bat           # Windows批处理打包脚本
├── build.ps1           # PowerShell打包脚本
├── README.md           # 使用说明文档
│
└── dist/               # 打包后的exe文件目录（打包后生成）
    └── 字体管理工具.exe
```

## 常见问题

### Q: 用户字体和系统字体有什么区别？
A: 
- **用户字体**：安装在当前用户目录，仅当前用户可用，无需管理员权限
- **系统字体**：安装在系统目录，所有用户可用，需要管理员权限

### Q: 推荐安装哪种类型的字体？
A: 推荐安装为"用户字体"，因为：
- 无需管理员权限，安装更方便
- 不会影响其他用户
- 卸载更安全
- 仅在需要所有用户共享字体时才安装为系统字体

### Q: 为什么不能卸载某些字体？
A: 系统字体（浅红色背景）受保护，不可通过本工具卸载。这是为了保护系统稳定性。只有用户字体（浅蓝色背景）可以卸载。

### Q: 为什么提示"权限不足"？
A: 安装**系统字体**需要管理员权限。推荐安装为"用户字体"，无需管理员权限。

### Q: 支持哪些字体格式？
A: 目前支持 .ttf（TrueType）、.otf（OpenType）和 .ttc（TrueType Collection）格式。

### Q: 卸载字体后需要重启吗？
A: 不需要，程序会自动通知系统刷新字体缓存。

### Q: 可以批量安装字体吗？
A: 可以，在选择文件对话框中按住 Ctrl 或 Shift 键选择多个字体文件。

### Q: 预览窗口显示不正常？
A: 部分特殊字体可能在预览时显示异常，这是正常现象，不影响字体的实际使用。

### Q: 如何区分列表中的字体类型？
A: 列表中使用不同背景色区分：浅红色为系统字体，浅蓝色为用户字体。

## 开发者信息

- **语言**: Python 3
- **开发时间**: 2025
- **许可证**: MIT License

## 更新日志

### v2.0.0 (2025-10-22) - 现代化UI大版本
- 🎨 **重大更新** 全新现代化扁平UI设计
- 🎨 **品牌升级** 应用精美的字体LOGO图标
- 🎨 **Arco Design** Tab采用下划线指示器风格，参考 [Arco Design Tabs](https://arco.design/react/components/tabs)
- 🎨 **DeepSeek Chat** 表格样式参考DeepSeek Chat，简洁纯净
- 🎨 **界面重构** 采用精心设计的配色方案
- 🎨 **视觉优化** 更大的窗口尺寸（1400x800）
- ✨ **新增** LOGO显示在标题栏，专业视觉形象
- ✨ **新增** 窗口图标使用自定义LOGO（.ico格式）
- ✨ **新增** Tab切换功能，快速浏览用户/系统字体
- ✨ **新增** Tab鼠标悬停效果，交互更流畅
- ✨ **新增** 线性图标按钮（⌕ + − ↻），更简洁
- ✨ **新增** 智能按钮状态：系统字体Tab时卸载按钮自动禁用
- 🔧 **改进** 去除表格背景色，更纯净的视觉效果
- 🔧 **改进** 更大的行高和间距，阅读更舒适
- 🔧 **改进** 现代化按钮样式（扁平化设计）
- 🔧 **改进** 优化状态栏和标题栏显示
- 🔧 **改进** Tab选中时黑色加粗，未选中时灰色
- ✅ **新增** 文件存在性验证，过滤无效字体

### v1.2.0 (2025-10-22)
- ✅ **新增** 左右分栏界面，操作更直观
- ✅ **新增** 点击字体即时预览，无需弹窗
- ✅ **新增** 系统字体保护机制，不可卸载
- ✅ **修复** 字体预览显示错误的问题
- ✅ **改进** 预览面板显示实际字体效果
- ✅ **改进** 用户体验，符合Windows字体管理规范

### v1.1.0 (2025-10-22)
- ✅ **新增** 系统字体和用户字体区分功能
- ✅ **新增** 用户字体支持（无需管理员权限）
- ✅ **新增** 字体类型列，不同颜色标识
- ✅ **新增** 安装时可选择字体类型
- ✅ **改进** 界面显示，添加字体统计信息
- ✅ **改进** 权限提示更友好

### v1.0.0 (2025-10-22)
- ✅ 初始版本发布
- ✅ 支持字体安装、卸载功能
- ✅ 支持字体预览和搜索
- ✅ 提供GUI界面
- ✅ 支持打包为exe可执行文件

## 许可证

MIT License - 自由使用、修改和分发

## 贡献

欢迎提交 Issue 和 Pull Request！

---

**享受字体管理的乐趣！** 🎨

